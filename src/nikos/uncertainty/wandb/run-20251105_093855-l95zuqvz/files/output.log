2025-11-05 09:38:56 WARNING  Recompute accuracy enabled. This does not apply to precomputed p_true!
2025-11-05 09:38:56 INFO     Initializing Llama judge model: Meta-Llama-3-8B
Initializing model:  Meta-Llama-3-8B and base: meta-llama
Loading checkpoint shards:  50%|█████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                 | 2/4 [00:20<00:20, 10.31s/it]
Traceback (most recent call last):
  File "C:\Users\nikos\PycharmProjects\nllSAR\src\compute_uncertainty_measures.py", line 360, in <module>
    main(args)
  File "C:\Users\nikos\PycharmProjects\nllSAR\src\compute_uncertainty_measures.py", line 167, in main
    metric = utils.get_metric(args.metric)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nikos\PycharmProjects\nllSAR\src\utils\utils.py", line 404, in get_metric
    metric = get_llama_metric(metric, max_new_tokens=50)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nikos\PycharmProjects\nllSAR\src\utils\utils.py", line 322, in get_llama_metric
    judge_model = HuggingfaceModel(
                  ^^^^^^^^^^^^^^^^^
  File "C:\Users\nikos\PycharmProjects\nllSAR\src\models\huggingface_models.py", line 128, in __init__
    self.model = AutoModelForCausalLM.from_pretrained(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nikos\Anaconda3\envs\nllSAR\Lib\site-packages\transformers\models\auto\auto_factory.py", line 564, in from_pretrained
    return model_class.from_pretrained(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nikos\Anaconda3\envs\nllSAR\Lib\site-packages\transformers\modeling_utils.py", line 4225, in from_pretrained
    ) = cls._load_pretrained_model(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nikos\Anaconda3\envs\nllSAR\Lib\site-packages\transformers\modeling_utils.py", line 4728, in _load_pretrained_model
    new_error_msgs, offload_index, state_dict_index = _load_state_dict_into_meta_model(
                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nikos\Anaconda3\envs\nllSAR\Lib\site-packages\transformers\modeling_utils.py", line 993, in _load_state_dict_into_meta_model
    set_module_tensor_to_device(model, param_name, param_device, **set_module_kwargs)
  File "C:\Users\nikos\Anaconda3\envs\nllSAR\Lib\site-packages\accelerate\utils\modeling.py", line 339, in set_module_tensor_to_device
    new_value = value.to(device)
                ^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 224.00 MiB. GPU 0 has a total capacity of 8.00 GiB of which 0 bytes is free. Of the allocated memory 22.49 GiB is allocated by PyTorch, and 1.20 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
